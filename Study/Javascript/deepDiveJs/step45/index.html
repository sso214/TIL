<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>45장. 프로미스 | sso214&#39;s TIL</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Today I Learned">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.dd5ac3b9.css" as="style"><link rel="preload" href="/TIL/assets/js/app.f9e688c1.js" as="script"><link rel="preload" href="/TIL/assets/js/2.f771dbe5.js" as="script"><link rel="preload" href="/TIL/assets/js/91.dbb61d6c.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.f47f9410.js"><link rel="prefetch" href="/TIL/assets/js/100.ddb16764.js"><link rel="prefetch" href="/TIL/assets/js/101.541c4da6.js"><link rel="prefetch" href="/TIL/assets/js/102.f0336a50.js"><link rel="prefetch" href="/TIL/assets/js/103.138dd674.js"><link rel="prefetch" href="/TIL/assets/js/104.64ec2866.js"><link rel="prefetch" href="/TIL/assets/js/105.ce9c46e5.js"><link rel="prefetch" href="/TIL/assets/js/106.a3de6de1.js"><link rel="prefetch" href="/TIL/assets/js/107.da20dce9.js"><link rel="prefetch" href="/TIL/assets/js/108.e71833f3.js"><link rel="prefetch" href="/TIL/assets/js/109.f9039969.js"><link rel="prefetch" href="/TIL/assets/js/11.ef9a23f0.js"><link rel="prefetch" href="/TIL/assets/js/110.861a8f24.js"><link rel="prefetch" href="/TIL/assets/js/111.96ad2f14.js"><link rel="prefetch" href="/TIL/assets/js/112.a1aa7724.js"><link rel="prefetch" href="/TIL/assets/js/113.a04876d5.js"><link rel="prefetch" href="/TIL/assets/js/114.45ff9fbe.js"><link rel="prefetch" href="/TIL/assets/js/115.2d4401df.js"><link rel="prefetch" href="/TIL/assets/js/116.26c179bd.js"><link rel="prefetch" href="/TIL/assets/js/117.f78e82e3.js"><link rel="prefetch" href="/TIL/assets/js/118.a8085e55.js"><link rel="prefetch" href="/TIL/assets/js/119.0d1e889b.js"><link rel="prefetch" href="/TIL/assets/js/12.4fb4905c.js"><link rel="prefetch" href="/TIL/assets/js/120.a83cd4f9.js"><link rel="prefetch" href="/TIL/assets/js/121.46cfbad6.js"><link rel="prefetch" href="/TIL/assets/js/122.dd3fa5e7.js"><link rel="prefetch" href="/TIL/assets/js/123.9fcf58c7.js"><link rel="prefetch" href="/TIL/assets/js/124.ef46d363.js"><link rel="prefetch" href="/TIL/assets/js/125.1869683c.js"><link rel="prefetch" href="/TIL/assets/js/126.b0c11642.js"><link rel="prefetch" href="/TIL/assets/js/127.47f5e3e3.js"><link rel="prefetch" href="/TIL/assets/js/128.fcd66afb.js"><link rel="prefetch" href="/TIL/assets/js/129.679c9117.js"><link rel="prefetch" href="/TIL/assets/js/13.f73cf031.js"><link rel="prefetch" href="/TIL/assets/js/130.b5bf4eea.js"><link rel="prefetch" href="/TIL/assets/js/131.89a7994e.js"><link rel="prefetch" href="/TIL/assets/js/132.b933e2bf.js"><link rel="prefetch" href="/TIL/assets/js/133.ab6f8036.js"><link rel="prefetch" href="/TIL/assets/js/134.1a473eed.js"><link rel="prefetch" href="/TIL/assets/js/135.d93fd680.js"><link rel="prefetch" href="/TIL/assets/js/136.26383400.js"><link rel="prefetch" href="/TIL/assets/js/137.c2cfe467.js"><link rel="prefetch" href="/TIL/assets/js/138.b98b93dd.js"><link rel="prefetch" href="/TIL/assets/js/139.5ec2df9b.js"><link rel="prefetch" href="/TIL/assets/js/14.5ef41c49.js"><link rel="prefetch" href="/TIL/assets/js/140.2516ecec.js"><link rel="prefetch" href="/TIL/assets/js/141.3f9b9cdd.js"><link rel="prefetch" href="/TIL/assets/js/142.83873ad9.js"><link rel="prefetch" href="/TIL/assets/js/143.e3e5d1b1.js"><link rel="prefetch" href="/TIL/assets/js/144.ec272627.js"><link rel="prefetch" href="/TIL/assets/js/145.75c48965.js"><link rel="prefetch" href="/TIL/assets/js/146.dcae26d9.js"><link rel="prefetch" href="/TIL/assets/js/147.984ed7cd.js"><link rel="prefetch" href="/TIL/assets/js/148.7c56d4c6.js"><link rel="prefetch" href="/TIL/assets/js/149.5cdf91ce.js"><link rel="prefetch" href="/TIL/assets/js/15.995d28da.js"><link rel="prefetch" href="/TIL/assets/js/150.498e8a11.js"><link rel="prefetch" href="/TIL/assets/js/151.7061e665.js"><link rel="prefetch" href="/TIL/assets/js/152.6eecd3d9.js"><link rel="prefetch" href="/TIL/assets/js/153.0f6d456a.js"><link rel="prefetch" href="/TIL/assets/js/154.4aa7ab6d.js"><link rel="prefetch" href="/TIL/assets/js/155.e9b07ba1.js"><link rel="prefetch" href="/TIL/assets/js/156.115f9f36.js"><link rel="prefetch" href="/TIL/assets/js/157.6582ac0b.js"><link rel="prefetch" href="/TIL/assets/js/158.8786e9f0.js"><link rel="prefetch" href="/TIL/assets/js/159.da9c323b.js"><link rel="prefetch" href="/TIL/assets/js/16.a5b45ecf.js"><link rel="prefetch" href="/TIL/assets/js/160.3c9356e4.js"><link rel="prefetch" href="/TIL/assets/js/161.72241bf1.js"><link rel="prefetch" href="/TIL/assets/js/162.34bd5f55.js"><link rel="prefetch" href="/TIL/assets/js/163.30e40e7c.js"><link rel="prefetch" href="/TIL/assets/js/164.97799ef3.js"><link rel="prefetch" href="/TIL/assets/js/165.29b93886.js"><link rel="prefetch" href="/TIL/assets/js/17.d72c01e6.js"><link rel="prefetch" href="/TIL/assets/js/18.447c505b.js"><link rel="prefetch" href="/TIL/assets/js/19.6c048798.js"><link rel="prefetch" href="/TIL/assets/js/20.1f985ee0.js"><link rel="prefetch" href="/TIL/assets/js/21.491825f7.js"><link rel="prefetch" href="/TIL/assets/js/22.c5be7d75.js"><link rel="prefetch" href="/TIL/assets/js/23.6f3ff941.js"><link rel="prefetch" href="/TIL/assets/js/24.27162c67.js"><link rel="prefetch" href="/TIL/assets/js/25.90d6c24c.js"><link rel="prefetch" href="/TIL/assets/js/26.0b39228b.js"><link rel="prefetch" href="/TIL/assets/js/27.82a0f40f.js"><link rel="prefetch" href="/TIL/assets/js/28.2644587a.js"><link rel="prefetch" href="/TIL/assets/js/29.34074a02.js"><link rel="prefetch" href="/TIL/assets/js/3.076ff747.js"><link rel="prefetch" href="/TIL/assets/js/30.3a731de4.js"><link rel="prefetch" href="/TIL/assets/js/31.a8b576d4.js"><link rel="prefetch" href="/TIL/assets/js/32.1987eb46.js"><link rel="prefetch" href="/TIL/assets/js/33.eb4531d1.js"><link rel="prefetch" href="/TIL/assets/js/34.4ade04e1.js"><link rel="prefetch" href="/TIL/assets/js/35.f82e864e.js"><link rel="prefetch" href="/TIL/assets/js/36.031c9dd4.js"><link rel="prefetch" href="/TIL/assets/js/37.88e21a96.js"><link rel="prefetch" href="/TIL/assets/js/38.ccc33b45.js"><link rel="prefetch" href="/TIL/assets/js/39.4e352e7b.js"><link rel="prefetch" href="/TIL/assets/js/4.e3ffd4e9.js"><link rel="prefetch" href="/TIL/assets/js/40.80cb32c4.js"><link rel="prefetch" href="/TIL/assets/js/41.0e7011c0.js"><link rel="prefetch" href="/TIL/assets/js/42.52451a6b.js"><link rel="prefetch" href="/TIL/assets/js/43.e7150500.js"><link rel="prefetch" href="/TIL/assets/js/44.425511a5.js"><link rel="prefetch" href="/TIL/assets/js/45.c8a5a88f.js"><link rel="prefetch" href="/TIL/assets/js/46.251b8c38.js"><link rel="prefetch" href="/TIL/assets/js/47.eb741fd6.js"><link rel="prefetch" href="/TIL/assets/js/48.e741df21.js"><link rel="prefetch" href="/TIL/assets/js/49.03d4fea0.js"><link rel="prefetch" href="/TIL/assets/js/5.ec0e461c.js"><link rel="prefetch" href="/TIL/assets/js/50.36ad14f7.js"><link rel="prefetch" href="/TIL/assets/js/51.c868c42e.js"><link rel="prefetch" href="/TIL/assets/js/52.fe63d705.js"><link rel="prefetch" href="/TIL/assets/js/53.e10b3cb0.js"><link rel="prefetch" href="/TIL/assets/js/54.1158f2c4.js"><link rel="prefetch" href="/TIL/assets/js/55.f24730af.js"><link rel="prefetch" href="/TIL/assets/js/56.24bddef0.js"><link rel="prefetch" href="/TIL/assets/js/57.2ea4417f.js"><link rel="prefetch" href="/TIL/assets/js/58.039d3107.js"><link rel="prefetch" href="/TIL/assets/js/59.84c37526.js"><link rel="prefetch" href="/TIL/assets/js/6.f401999e.js"><link rel="prefetch" href="/TIL/assets/js/60.717ad78e.js"><link rel="prefetch" href="/TIL/assets/js/61.02dac972.js"><link rel="prefetch" href="/TIL/assets/js/62.c9dfd9d7.js"><link rel="prefetch" href="/TIL/assets/js/63.0cc9b324.js"><link rel="prefetch" href="/TIL/assets/js/64.1d9d16e6.js"><link rel="prefetch" href="/TIL/assets/js/65.bb18a4c7.js"><link rel="prefetch" href="/TIL/assets/js/66.8c0a8938.js"><link rel="prefetch" href="/TIL/assets/js/67.e494060d.js"><link rel="prefetch" href="/TIL/assets/js/68.f3a05199.js"><link rel="prefetch" href="/TIL/assets/js/69.7423de44.js"><link rel="prefetch" href="/TIL/assets/js/7.8e298897.js"><link rel="prefetch" href="/TIL/assets/js/70.ec8cd6f7.js"><link rel="prefetch" href="/TIL/assets/js/71.a7cbf400.js"><link rel="prefetch" href="/TIL/assets/js/72.77e1a947.js"><link rel="prefetch" href="/TIL/assets/js/73.263adae3.js"><link rel="prefetch" href="/TIL/assets/js/74.d6885f6e.js"><link rel="prefetch" href="/TIL/assets/js/75.dbe2b5b4.js"><link rel="prefetch" href="/TIL/assets/js/76.de4b476b.js"><link rel="prefetch" href="/TIL/assets/js/77.d9769285.js"><link rel="prefetch" href="/TIL/assets/js/78.2becc0ec.js"><link rel="prefetch" href="/TIL/assets/js/79.fb13603f.js"><link rel="prefetch" href="/TIL/assets/js/8.cb9c5b27.js"><link rel="prefetch" href="/TIL/assets/js/80.442d805c.js"><link rel="prefetch" href="/TIL/assets/js/81.77dc18c4.js"><link rel="prefetch" href="/TIL/assets/js/82.d6b36fe3.js"><link rel="prefetch" href="/TIL/assets/js/83.32c87fba.js"><link rel="prefetch" href="/TIL/assets/js/84.71870a5b.js"><link rel="prefetch" href="/TIL/assets/js/85.dc7a35ca.js"><link rel="prefetch" href="/TIL/assets/js/86.6a68a564.js"><link rel="prefetch" href="/TIL/assets/js/87.0dbbbec1.js"><link rel="prefetch" href="/TIL/assets/js/88.d5978c78.js"><link rel="prefetch" href="/TIL/assets/js/89.56e734b9.js"><link rel="prefetch" href="/TIL/assets/js/9.abe93009.js"><link rel="prefetch" href="/TIL/assets/js/90.ffc2aba1.js"><link rel="prefetch" href="/TIL/assets/js/92.8e0a5413.js"><link rel="prefetch" href="/TIL/assets/js/93.f013ac8b.js"><link rel="prefetch" href="/TIL/assets/js/94.5862a8b3.js"><link rel="prefetch" href="/TIL/assets/js/95.dc1f47ed.js"><link rel="prefetch" href="/TIL/assets/js/96.3f9b18ae.js"><link rel="prefetch" href="/TIL/assets/js/97.f97a0ac0.js"><link rel="prefetch" href="/TIL/assets/js/98.62be6a02.js"><link rel="prefetch" href="/TIL/assets/js/99.4e63f272.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.dd5ac3b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">sso214's TIL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/TIL/study/" class="nav-link">
  Study
</a></div><div class="nav-item"><a href="/TIL/log/" class="nav-link">
  Log
</a></div><div class="nav-item"><a href="/TIL/memo/" class="nav-link">
  Memo
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="sso214" class="dropdown-title"><span class="title">sso214</span> <span class="arrow down"></span></button> <button type="button" aria-label="sso214" class="mobile-dropdown-title"><span class="title">sso214</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/TIL/info/" class="nav-link">
  Info
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/sso214" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/TIL/study/" class="nav-link">
  Study
</a></div><div class="nav-item"><a href="/TIL/log/" class="nav-link">
  Log
</a></div><div class="nav-item"><a href="/TIL/memo/" class="nav-link">
  Memo
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="sso214" class="dropdown-title"><span class="title">sso214</span> <span class="arrow down"></span></button> <button type="button" aria-label="sso214" class="mobile-dropdown-title"><span class="title">sso214</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/TIL/info/" class="nav-link">
  Info
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/sso214" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TIL/Study/" aria-current="page" class="sidebar-link">Study</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Canvas</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Django</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Etc</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ReactNative</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nodeJs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_45장-프로미스"><a href="#_45장-프로미스" class="header-anchor">#</a> 45장. 프로미스</h1> <p>자바스크립트는 비동기 처리를 위한 하나의 패턴으로 콜백 함수 사용<br>
하지만 콜백 헬로 인해 가독성이 나쁘고 에러의 처리가 곤란하며<br>
여러개의 비동기 처리를 한번에 처리하는데도 한계 존재</p> <p>때문에 ES6에선 비동기 처리를 위해 프로미스를 도입함<br>
콜백 패턴의 단점을 보완하고 비동기 처리 시점을 명확하게 표현할 수 있는 장점 있음</p> <h2 id="_1-비동기-처리를-위한-콜백-패턴의-단점"><a href="#_1-비동기-처리를-위한-콜백-패턴의-단점" class="header-anchor">#</a> 1. 비동기 처리를 위한 콜백 패턴의 단점</h2> <h3 id="_1-1-콜백-헬"><a href="#_1-1-콜백-헬" class="header-anchor">#</a> 1-1. 콜백 헬</h3> <p>비동기 함수 : 함수 내부에 비동기로 동작하는 코드를 포함한 함수<br>
비동기 함수 내부의 비동기 코드는 비동기 함수가 종료된 이후에 완료됨<br>
따라 비동기 함수 내부의 비동기로 동작하는 코드에서 처리 결과를 외부로 반환하거나<br>
상위 스코프의 변수에 할당하면 기대한 대로 동작하지 않음</p> <p>get 함수 호출 시 GET 요청을 전송하고<br>
onload 이벤트 핸들러를 등록한 뒤 undefined를 반환하고 즉시 종료됨<br>
즉, 비동기 함수인 get 함수 내부의 onload 이벤트 핸들러는 get 함수가 종료된 이후에 실행됨</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// GET 요청을 위한 비동기 함수</span>
<span class="token keyword">const</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token parameter">url</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 서버의 응답을 콘솔에 출력한다.</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>statusText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// id가 1인 post를 취득</span>
<span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/posts/1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
&quot;userId&quot;: 1,
&quot;id&quot;: 1,
&quot;title&quot;: &quot;sunt aut facere ...&quot;,
&quot;body&quot;: &quot;quia et suscipit ...&quot;
}
*/</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> todos<span class="token punctuation">;</span>
<span class="token comment">// GET 요청을 위한 비동기 함수</span>
<span class="token keyword">const</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token parameter">url</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ① 서버의 응답을 상위 스코프의 변수에 할당한다.</span>
            todos <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>statusText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// id가 1인 post를 취득</span>
<span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/posts/1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ② undefined</span>
</code></pre></div><p>xhr.onload 이벤트 핸들러에서 서버의 응답을 상위 스코프의 변수에 할당하면 처리 순서가 보장되지 않음<br>
비동기 함수 get 호출 -&gt; 함수 코드 평가 과정에서 get 함수의 실행 컨텍스트가 생성<br>
-&gt; 실행 컨텍스트 스택 (콜 스택)에 푸시됨 -&gt; 함수 코드 실행과정에서 xhr.onload 이벤트 핸들러 프로퍼티에<br>
이벤트 핸들러 바인딩됨 -&gt; get 함수 종료 시 get 함수의 실행 컨텍스트가 콜 스택에서 팝 됨<br>
-&gt; 만약 console.log 호출 직전에 load 이벤트가 발생했더라도 xhr.onload 이벤트 핸들러 프로퍼티에<br>
바인딩한 이벤트 핸들러는 결코 console.log 보다 먼저 실행되지 않음</p> <p>이처럼 비동기 함수는 비동기 처리 결과를 외부에 반환 불가능하고, 상위 스코프의 변수에 할당도 불가능함<br>
따라 비동기 함수의 처리 결과(서버의 응답 등) 후속 처리는 비동기 함수 내부에서 수행해야 함<br>
이떄 비동기 함수를 범용적으로 사용하기 위해 비동기 함수에<br>
비동기 처리 결과 후속 처리를 수행하는 콜백 함수를 전달하는 것이 일반적<br>
필요에 따라 비동기 처리가 성공 시 호출될 콜백 함수와 비동기 처리가 실패하면 호출될 콜백 함수 전달 가능</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// GET 요청을 위한 비동기 함수</span>
<span class="token keyword">const</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> successCallback<span class="token punctuation">,</span> failureCallback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 서버의 응답을 콜백 함수에 인수로 전달하면서 호출하여 응답에 대한 후속 처리를 한다.</span>
            <span class="token function">successCallback</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 에러 정보를 콜백 함수에 인수로 전달하면서 호출하여 에러 처리를 한다.</span>
            <span class="token function">failureCallback</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// id가 1인 post를 취득</span>
<span class="token comment">// 서버의 응답에 대한 후속 처리를 위한 콜백 함수를 비동기 함수인 get에 전달해야 한다.</span>
<span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/posts/1'</span><span class="token punctuation">,</span> console<span class="token punctuation">.</span>log<span class="token punctuation">,</span> console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
&quot;userId&quot;: 1,
&quot;id&quot;: 1,
&quot;title&quot;: &quot;sunt aut facere ...&quot;,
&quot;body&quot;: &quot;quia et suscipit ...&quot;
}
*/</span>
</code></pre></div><p>이처럼 콜백 함수를 통해 비동기 처리 결과 후속 처리를 수행하는 비동기 함수가<br>
비동기 처리 결과를 가지고 또다시 비동기 함수를 호출해야 한다면<br>
콜백 함수 호출이 중첩되어 복잡도가 높아지는 현상 발생함<br>
이를 <strong>콜백 헬</strong>이라고 함<br>
콜백 헬은 가독성을 나쁘게 하며 실수를 유발하는 원인이 됨</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// GET 요청을 위한 비동기 함수</span>
<span class="token keyword">const</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 서버의 응답을 콜백 함수에 전달하면서 호출하여 응답에 대한 후속 처리를 한다.</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>xhr<span class="token punctuation">.</span>statusText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com'</span><span class="token punctuation">;</span>
<span class="token comment">// id가 1인 post의 userId를 취득</span>
<span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/posts/1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>userId<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
    <span class="token comment">// post의 userId를 사용하여 user 정보를 취득</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">userInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {id: 1, name: &quot;Leanne Graham&quot;, username: &quot;Bret&quot;,...}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/step1'</span><span class="token punctuation">,</span> <span class="token parameter">a</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/step2/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">b</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/step3/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/step4/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>c<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-2-에러-처리의-한계"><a href="#_1-2-에러-처리의-한계" class="header-anchor">#</a> 1-2. 에러 처리의 한계</h3> <p>콜백 패턴의 문제점 중 가장 심각한 것은 에러 처리가 곤란하다는 것</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Error!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 에러를 캐치하지 못한다</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'캐치한 에러'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>try 코드 블록 내에서 호출한 setTimeout 함수는 1초 후 콜백 함수가 실행되도록 타이머를 설정하고,<br>
이후 콜백 함수는 에러를 발생시킴. 하지만 에러는 catch 코드 블록에서 캐치되지 않음</p> <p>setTimeout 호출되면 실행 컨텍스트가 생성되어 콜 스택에 푸시되어 실행됨.<br>
setTimeout은 비동기 함수이므로 콜백 함수 호출을 기다리지 않고 즉시 종료되어 콜 스택에서 제거됨<br>
이후 타이머가 만료되면 setTimeout함수의 콜백 함수는 태스크 큐로 푸시되고<br>
콜 스택이 비어졌을 때 이벤트 루프에 의해 콜 스택으로 푸시되어 실행됨</p> <p>setTimeout 함수의 콜백 함수가 실행될 때 setTimeout 함수는 이미 콜 스택에서 제거된 상태<br>
즉, setTimeout 함수의 콜백 함수를 호출한 것이 setTimeout 함수가 아니라는 것을 의미</p> <p>에러는 호출자 방향으로 전파됨. 즉, 콜 스택의 아래방향으로 전파됨<br>
setTimeout 함수의 콜백 함수를 호출한 것은 setTimeout 함수가 아님<br>
따라 setTimeout 함수의 콜백 함수가 발생시킨 에러는 catch 블록에서 캐치되지 않음</p> <p>이렇듯 비동기 처리를 위한 콜백 패턴은 콜백 헬이나 에러 처리가 곤란한 문제가 있음<br>
이를 극복하기 위해 ES6에서 프로미스가 도입</p> <h4 id="try-catch-finally-문"><a href="#try-catch-finally-문" class="header-anchor">#</a> try ...catch ...finally 문</h4> <ul><li>에러 처리를 구현하는 방법</li> <li>try ...catch ...finally 문 실행 시 먼저 try 코드 블록 실행됨<br>
이때 try 코드 블록에 포함된 문 중 에러 발생 시 해당 에러는 catch 문의 err 변수에 전달되고<br>
catch 코드 블록이 실행됨. finally 코드 블록은 에러 발생과 상관없이 반드시 한번 실행됨</li> <li>try ...catch ...finally 문으로 에러 처리 시 프로그램이 강제 종료되지 않음</li></ul> <h2 id="_2-프로미스의-생성"><a href="#_2-프로미스의-생성" class="header-anchor">#</a> 2. 프로미스의 생성</h2> <ul><li>Promise 생성자 함수를 new 연산자와 함께 호출 시 프로미스 객체를 생성함</li> <li>ES6에서 도입된 Promise는 호스트 객체가 아닌 ECMAScript 사양에 정의된 표준 빌트인 객체</li> <li>Promise 생성자 함수는 비동기 처리를 수행할 콜백 함수를 인수로 전달받는데<br>
이 콜백 함수는 resolve와 reject 함수를 인수로 전달받음</li> <li>Promise 생성자 함수가 인수로 전달받은 콜백 함수 내부에서 비동기 처리를 수행함<br>
이때 비동기 처리가 성공하면 콜백 함수의 인수로 전달받은 resolve 함수를 호출,<br>
실패 시 reject 함수를 호출함<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 프로미스 생성</span>
<span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Promise 함수의 콜백 함수 내부에서 비동기 처리를 수행한다.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/* 비동기 처리 성공 */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'result'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">/* 비동기 처리 실패 */</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'failure reason'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>프로미스는 아래와 같이 현재 비동기 처리가 어떻게 진행되고 있는지의 상태 정보를 갖음
<table><thead><tr><th style="text-align:left;">프로미스의 상태 정보</th> <th style="text-align:left;">의미</th> <th style="text-align:left;">상태 변경 조건</th></tr></thead> <tbody><tr><td style="text-align:left;">pending</td> <td style="text-align:left;">비동기 처리가 아직 수행되지 않은 상태</td> <td style="text-align:left;">프로미스가 생성된 직후 기본 상태</td></tr> <tr><td style="text-align:left;">fulfilled</td> <td style="text-align:left;">비동기 처리가 수행된 상태(성공)</td> <td style="text-align:left;">resolve 함수 호출</td></tr> <tr><td style="text-align:left;">rejected</td> <td style="text-align:left;">비동기 처리가 수행된 상티(실패)</td> <td style="text-align:left;">reject 함수 호출</td></tr></tbody></table>
생성된 직후의 프로미스는 기본적으로 pending 상태<br>
이후 비동기 처리 수행 시 처리 결과에 따라 프로미스의 상태가 변경됨
<ul><li>비동기 처리 성공 : resolve 함수를 호출해 프로미스를 fulfilled 상태로 변경</li> <li>비동기 처리 실패 : reject 함수를 호출해 프로미스를 rejected 상태로 변경<br>
이처럼 프로미스의 상태는 resolve 또는 reject 함수를 호출하는 것으로 결정됨</li></ul></li> <li>fulfilled / rejected 상태를 settled 상태라고 함<br>
settled 상태는 pending이 아닌 상태로 비동기 처리가 수행된 상태를 말함</li> <li>프로미스는 pending 상태에서 settled 상태로 변화 가능함<br>
하지만 일단 settled 상태가 되면 더는 다른 상태로 변화할 수 없음</li> <li>프로미스는 비동기 처리 상태와 더불어 비동기 처리 결과도 상태로 갖음<br>
즉, 프로미스는 비동기 처리 상태와 처리 결과를 관리하는 객체</li></ul> <h2 id="_3-프로미스의-후속-처리-메서드"><a href="#_3-프로미스의-후속-처리-메서드" class="header-anchor">#</a> 3. 프로미스의 후속 처리 메서드</h2> <p>프로미스의 비동기 처리 상태가 변화하면 이에 따른 후속 처리를 해야 함<br>
이를 위해 프로미스는 후속 메서드 then, catch, finally를 제공함</p> <p>프로미스의 비동기 처리 상태가 변화하면 후속 처리 메서드에 인수로 전달한 콜백 함수가 선택적으로 호출됨<br>
이때 후속 처리 메서드의 콜백 함수에 프로미스의 처리 결과가 인수로 전달됨</p> <p>모든 후속 처리 메서드는 프로미스를 반환하며, 비동기로 동작함</p> <h3 id="_3-1-promise-prototype-then"><a href="#_3-1-promise-prototype-then" class="header-anchor">#</a> 3-1. Promise.prototype.then</h3> <ul><li><p>then 메서드는 두 개의 콜백 함수를 인수로 전달받음</p> <ul><li>첫 번째 콜백 함수 : 프로미스가 fulfilled 상태 (resolve 함수가 호출된 상태)가 되면 호출됨<br>
이때 콜백 함수는 프로미스의 비동기 처리 결과를 인수로 전달받음</li> <li>두 번째 콜백 함수 : 프로미스가 rejected 상태(reject 함수가 호출된 상태)가 되면 호출됨<br>
이때 콜백 함수는 프로미스의 에러를 인수로 전달받음</li></ul></li> <li><p>then 메서드는 언제나 프로미스를 반환함<br>
만약 then 메서드의 콜백 함수가 프로미스를 반환하면 그 프로미스를 그대로 반환하고,<br>
프로미스가 아닌 값을 반환 시 암묵적으로 값을 resolve 또는 reject 해 프로매스를 생성해 반환함</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// fulfilled</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'fulfilled'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fulfilled</span>

<span class="token comment">// rejected</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'rejected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: rejected</span>
</code></pre></div><h3 id="_3-2-promise-prototype-catch"><a href="#_3-2-promise-prototype-catch" class="header-anchor">#</a> 3-2. Promise.prototype.catch</h3> <ul><li>catch 메서드는 한 개의 콜백 함수를 인수로 전달받음<br>
catch 메서드의 콜백 함수는 프로미스가 rejected 상태인 경우에만 호출됨<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// rejected</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'rejected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: rejected</span>
</code></pre></div></li> <li>catch 메서드는 then(undefined, onRejected)와 동일하게 동작함<br>
따라 then 메서드와 마찬가지로 언제나 프로미스를 반환함<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// rejected</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'rejected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: rejected</span>
</code></pre></div></li></ul> <h3 id="_3-3-promise-prototype-finally"><a href="#_3-3-promise-prototype-finally" class="header-anchor">#</a> 3-3. Promise.prototype.finally</h3> <ul><li>finally 메서드는 한 개의 콜백 함수를 인수로 전달받음<br>
finally 메서드의 콜백 함수는 프로미스의 성공이나 실패에 상관없이 무조건 한 번 호출됨</li> <li>프로미스의 상태와 상관없이 공통적으로 수행해야 할 처리 내용이 있을 때 유용</li> <li>then/catch 메서드와 마찬가지로 언제나 프로미스를 반환함<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finally'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// finally</span>
</code></pre></div></li></ul> <h3 id="프로미스로-구현한-비동기-함수-get을-사용해-후속-처리-구현"><a href="#프로미스로-구현한-비동기-함수-get을-사용해-후속-처리-구현" class="header-anchor">#</a> 프로미스로 구현한 비동기 함수 get을 사용해 후속 처리 구현</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">promiseGet</span> <span class="token operator">=</span> <span class="token parameter">url</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 성공적으로 응답을 전달받으면 resolve 함수를 호출한다.</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">// 에러 처리를 위해 reject 함수를 호출한다.</span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// promiseGet 함수는 프로미스를 반환한다.</span>
<span class="token function">promiseGet</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/posts/1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Bye!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_4-프로미스의-에러-처리"><a href="#_4-프로미스의-에러-처리" class="header-anchor">#</a> 4. 프로미스의 에러 처리</h2> <ul><li>비동기 처리에서 발생한 에러는 then 메서드의 두 번째 콜백 함수로 처리 가능함<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> wrongUrl <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com/XXX/1'</span><span class="token punctuation">;</span>
<span class="token comment">// 부적절한 URL이 지정되었기 때문에 에러가 발생한다.</span>

<span class="token function">promiseGet</span><span class="token punctuation">(</span>wrongUrl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 404</span>
</code></pre></div></li> <li>또한 프로미스의 후속 처리 메서드 catch를 사용해 처리도 가능<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> wrongUrl <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com/XXX/1'</span><span class="token punctuation">;</span>
<span class="token comment">// 부적절한 URL이 지정되었기 때문에 에러가 발생한다.</span>

<span class="token function">promiseGet</span><span class="token punctuation">(</span>wrongUrl<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 404</span>
</code></pre></div>catch 메서드 호출 시 내부적으로 then(undefined, onRejected)를 호출함<br>
따라 위 예제는 내부적으로 아래와 같이 처리됨<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> wrongUrl <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com/XXX/1'</span><span class="token punctuation">;</span>
<span class="token comment">// 부적절한 URL이 지정되었기 때문에 에러가 발생한다.</span>
<span class="token function">promiseGet</span><span class="token punctuation">(</span>wrongUrl<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 404</span>
</code></pre></div>단, then 메서드의 두 번째 콜백 함수는 첫 번째 콜백 함수에서 발생한 에러를 캐치하지 못하고<br>
코드가 복잡해져서 가독성이 좋지 않음<div class="language-js extra-class"><pre class="language-js"><code><span class="token function">promiseGet</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/todos/1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">xxx</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 두 번째 콜백 함수는 첫 번째 콜백 함수에서 발생한 에러를 캐치하지 못한다.</span>
</code></pre></div>catch 메서드를 모든 then 메서드를 호출한 이후에 호출 시 비동기 처리에서 발생한 에러 뿐 아니라<br>
then 메서드 내부에서 발생한 에러까지 모두 캐치 가능함<div class="language-js extra-class"><pre class="language-js"><code><span class="token function">promiseGet</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/todos/1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">xxx</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError: console.xxx is not a function</span>
</code></pre></div>또한 catch 메서드를 사용하는 것이 가독성이 좋고 명확함<br>
따라 에러 처리는 catch 메서드에서 하는 것을 권장함</li></ul> <h2 id="_5-프로미스-체이닝"><a href="#_5-프로미스-체이닝" class="header-anchor">#</a> 5. 프로미스 체이닝</h2> <p>콜백 패턴은 콜백 헬이 발생하는 문제가 있음<br>
프로미스는 then, catch, finally 후속 처리 메서드를 통해 콜백 헬을 해결함</p> <p>then, catch, finally 후속 처리 메서드는 언제나 프로미스를 반환하므로 연속적으로 호출 가능함<br>
(= 프로미스 체이닝)</p> <p>프로미스는 프로미스 체이닝을 통해 비동기 처리 결과를 전달받아 후속 처리를 하므로 콜백 헬이 발생하지 않음<br>
다만 프로미스도 콜백 패턴을 사용하므로 콜백 함수를 사용하지 않는 것은 아님</p> <p>콜백 패턴은 가능성이 좋지 않음<br>
이를 위해 ES8에서는 async/await를 도입함<br>
async/await 사용 시 프로미스의 후속 처리 메서드 없이 마치 동기 처리처럼<br>
프로미스가 처리 결과를 반환하도록 구현 가능함</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com'</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// id가 1인 post의 userId를 취득</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>userId<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">promiseGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/posts/1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 취득한 post의 userId로 user 정보를 취득</span>
    <span class="token keyword">const</span> userInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">promiseGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>async/await도 프로미스를 기반으로 동작하므로 프로미스를 잘 이해해야 함</p> <h2 id="_6-프로미스의-정적-메서드"><a href="#_6-프로미스의-정적-메서드" class="header-anchor">#</a> 6. 프로미스의 정적 메서드</h2> <p>Promise는 주로 생성자 함수로 사용되지만 함수도 객체이므로 메서드 소유 가능함<br>
Promise는 5가지 정적 메서드를 제공함</p> <h3 id="_6-1-promise-resolve-promise-reject"><a href="#_6-1-promise-resolve-promise-reject" class="header-anchor">#</a> 6-1. Promise.resolve / Promise.reject</h3> <p>Promise.resolve와 Promise.reject 메서드는 이미 존재하는 값을<br>
래핑해 프로미스를 생성하기 위해 사용함</p> <ul><li>Promise.resolve 메서드는 인수로 전달받은 값을 resolve 하는 프로미스를 생성함<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 배열을 resolve하는 프로미스를 생성</span>
<span class="token keyword">const</span> resolvedPromise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
resolvedPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3]</span>
</code></pre></div>위 코드는 아래 코드와 동일하게 작동함<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> resolvedPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
resolvedPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3]</span>
</code></pre></div></li> <li>Promise.reject 메서드는 인수로 전달받은 값을 reject 하는 프로미스를 생성함<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 에러 객체를 reject하는 프로미스를 생성</span>
<span class="token keyword">const</span> rejectedPromise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Error!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rejectedPromise<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: Error!</span>
</code></pre></div>위 코드는 아래 코드와 동일하게 작동함<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> rejectedPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Error!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rejectedPromise<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: Error!</span>
</code></pre></div></li></ul> <h3 id="_6-2-promise-all"><a href="#_6-2-promise-all" class="header-anchor">#</a> 6-2. Promise.all</h3> <ul><li>Promise.all 메서드느 여러 개의 비동기 처리를 모두 병렬 처리할 때 사용함</li> <li>앞선 비동기 처리 결과를 다음 비동기 처리에 사용하지 않아 서로 의존하지 않고<br>
개별적으로 수행되는 비동기 처리의 경우 Promise.all 사용</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">requestData1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">requestData2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">requestData3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 세 개의 비동기 처리를 병렬로 처리</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">requestData1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">requestData2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">requestData3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span> <span class="token comment">// [ 1, 2, 3 ] ⇒ 약 3초 소요</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Promise.all 메서드는 프로미스를 요소로 갖는 배열 등의 이터러블을 인수로 전달받음<br>
그리고 전달받은 모든 프로미스가 모두 fulfilled 상태가 되면 모든 처리 결과를<br>
배열에 저장해 새로운 프로미스를 반환함</li> <li>Promise.all 메서드는 인수로 전달받은 배열의 모든 프로미스가 모두 fulfilled 상태가 되면 종료함<br>
따라 Promise.all 메서드가 종료하는데 걸리는 시간은<br>
가장 늦게 fulfilled 상태가 된느 프로미스의 처리 시간보다 조금 더 김</li> <li>모든 프로미스가 fulfilled 상태가 되면 reosolve된 처리 결과를 모두 배열에 저장해 새로운 프로미스를 반환함<br>
이때 프로미스의 상태 변화 순서와 상관 없이 처리 결과를 차례대로 배열에 저장함<br>
즉, 처리 순서가 보장됨</li> <li>Promise.all 메서드는 인수로 전달받은 배열의 프로미스가 하나라도 rejected 상태가 되면<br>
나머지 프로미스가 fulfilled 상태가 되는 것을 기다리지 않고 즉시 종료함</li> <li>Promise.all 메서드는 인수로 전달받은 이터러블의 요소가 프로미스가 아닌 경우<br>
Promise.resolve 메서드를 통해 프로미스로 래핑함</li></ul> <h3 id="_6-3-promise-race"><a href="#_6-3-promise-race" class="header-anchor">#</a> 6-3. Promise.race</h3> <ul><li>Promise.all 메서드와 동일하게 프로미스를 요소로 갖는 배열 등의 이터러블을 인수로 전달받음</li> <li>가장 먼저 fulfilled 상태가 된 프로미스의 처리 결과를 resolve 하는 새로운 프로미스를 반환함</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 1</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 2</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span> <span class="token comment">// 3</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.f9e688c1.js" defer></script><script src="/TIL/assets/js/2.f771dbe5.js" defer></script><script src="/TIL/assets/js/91.dbb61d6c.js" defer></script>
  </body>
</html>
